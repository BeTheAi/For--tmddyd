<!doctype html>
<html>
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

    <title>Service</title>
	  
	<style>
		
		.float:hover {
			background: #42A5F5;
		}
		.float div {
			font-size: 1.8em;
			padding: 0;
			margin: .22em 0 0 0;
		}
		
		
		
	</style>
	  
	<style>
		.left {
			width: 50%;
			float: left;
			box-sizing: border-box;
			background: #ffffff;
    	}
		.right {
			width: 50%;
			float: right;
			padding: 5px;
    	}
    </style>
	  
	<style>
		.float{
		  position: fixed;
		  width: 60px;
		  height: 60px;
		  bottom: 40px;
		  right: 22px;
		  background-color: #0C9;
		  color: #FFF;
		  border-radius: 50px;
		  text-align: center;
		  box-shadow: 2px 2px 3px #999;
		}

		.my-float{
		  margin-top:22px;
		}


		.label-container{
		  position:fixed;
		  bottom:48px;
		  right:105px;
		  display:table;
		  visibility: hidden;
		}

		.label-text{
		  color:#FFF;
		  background:rgba(51,51,51,0.5);
		  display:table-cell;
		  vertical-align:middle;
		  padding:10px;
		  border-radius:3px;
		}

		.label-arrow{
		  display:table-cell;
		  vertical-align:middle;
		  color:#333;
		  opacity:0.5;
		}

		.my-float{
		  font-size:24px;
		  margin-top:18px;
		}

		a.float + div.label-container {
		  visibility: hidden;
		  opacity: 0;
		  transition: visibility 0s, opacity 0.5s ease;
		}

		a.float:hover + div.label-container{
		  visibility: visible;
		  opacity: 1;
		}

		a.float:hover .user-req-list {
		  visibility: collapse;
		}

		.user-req-list {
		  visibility: hidden;
		}
		
		.chatbox {
			width: 33%;
			height: 55%;
			position: absolute;
			right: 0px;
			bottom: -6%;
			border-radius: 10px;
			box-shadow: 5px 5px 15px rgba($dark, 0.5);
			margin-right: 5px;
			margin-bottom: 10%;
			box-sizing: border-box;
			background: #ece6cc;
			padding: 5px;
		}
	</style>
  </head>
  <body>
    <%- include ("./nav.ejs") %>
	<div class="container mt-4">
		<h4 class='m-5 text-center'>서비스 데스크</h4>

		<div class="accordion left" id="accordionExample">
		  <div class="card">
			<div class="card-header" id="headingOne">
			  <h2 class="mb-0">
				<button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
				  자주 묻는 질문 #1
				</button>
			  </h2>
			</div>

			<div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
			  <div class="card-body">
				Some placeholder content for the first accordion panel. This panel is shown by default, thanks to the <code>.show</code> class.
			  </div>
			</div>
		  </div>
		  <div class="card">
			<div class="card-header" id="headingTwo">
			  <h2 class="mb-0">
				<button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
				  자주 묻는 질문 #2
				</button>
			  </h2>
			</div>
			<div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">
			  <div class="card-body">
				Some placeholder content for the second accordion panel. This panel is hidden by default.
			  </div>
			</div>
		  </div>
		  <div class="card">
			<div class="card-header" id="headingThree">
			  <h2 class="mb-0">
				<button class="btn btn-link btn-block text-left collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
				  자주 묻는 질문 #3
				</button>
			  </h2>
			</div>
			<div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
			  <div class="card-body">
				And lastly, the placeholder content for the third and final accordion panel. This panel is hidden by default.
			  </div>
			</div>
		  </div>
		</div>
		<div class='right'>
			<li class="list-group-item">빈 공간</li>
		</div>
	  </div>
	  
	<div class="chatbox" style='display:none;'>
		<li class="list-group-item">실시간 채팅방입니다.</li>
		<ul class="list-group" style='height: 79%; overflow-y: scroll;'>

		</ul>

		<div class="input-group mt-3">
			<input type="text" class="form-control" id='sendmsg' placeholder="메시지를 입력하세요." onKeyPress='event.keyCode == 13 && send();' aria-describedby="button-addon2">
			<div class="input-group-append">
				<button class="btn btn-outline-secondary" type="button" id="send" onclick='send();'>전송</button>
			</div>
		</div>
	</div>
	  
	  
	<div class="dropup">
	  <a class="float"  role="button">
		<i class="fa fa-plus my-float"></i>
	  </a>
	  <div class="label-container">
		<div class="label-text">Chating</div>
		<i class="fa fa-play label-arrow"></i>
	  </div>
		
	</div>
	  
	  
	  <button id='joinpub'>join public</button>
	  <button id='join1'>join room_1</button>
	  <button id='join2'>join room_2</button>
	
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<!-- client용 script -->
	<script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js'></script>
	  
	<script>
		var socket = io('/chat');
		socket.emit('req', 'public');
		socket.on('broadcast', (data) => {
			$('.list-group').append('<li class="list-group-item">' + data + '</li>');
			$('.list-group').scrollTop($('.list-group').prop('scrollHeight'));
			$('#sendmsg')[0].value = '';
		})
		
		$('#joinpub').click( () => {
			//socket.io 라이브러리 사용
			socket.emit('req', 'public'); //namespace 사용	
		})
		
		$('#join1').click( () => {
			
			socket.emit('req', 'room_1');
		})
		$('#join2').click( () => {
			var pw = prompt('비밀번호를 입력해주세요.');
			console.log(pw)
			socket.emit('req', {roomnum: 'room_2', pw: pw});
		})
		//data 전송 함수
		function send() {
			console.log('send() has been active');
			if($("#sendmsg").val().length > 0) {
				var sendmsg = $("#sendmsg").val();
				socket.emit('sendmsg', sendmsg);
			}
		}
		
		//chating box 켜고 끄기
		$(".float").click( () => {
			if($(".chatbox")[0].style.display == 'none'){
				$(".chatbox")[0].style.display = 'block';
			}else{
				$(".chatbox")[0].style.display = 'none';
			}
		})
		
	</script>
	  
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>
  </body>
</html>